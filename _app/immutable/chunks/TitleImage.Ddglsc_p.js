import{n as Q,q as He,a as M,b as K,j as te,g as Xe,u as qe,h as Le,i as Ve,r as $e,e as Fe,F as gt,E as ln,G as un,f as vt,k as at,c as mt,o as yn,t as wn,l as wt,D as bt,H as pt,I as Dt,J as Dn}from"./scheduler.B5c9wP8t.js";import{S as F,i as j,e as D,c as E,a as R,d as w,m as g,g as U,C as X,p as q,q as Y,s as L,z as ue,f as V,n as A,h as v,A as Et,B as ft,k as ye,l as we,o as De,x as je,w as xe,r as Ee,F as En,I as Cn,v as pe,t as he,b as de,u as fe,J as ae,K as Te,L as cn,j as Je,E as In,M as Ct}from"./index.BpXyRbRA.js";import{w as ke}from"./index.DqKJIJFH.js";import{r as Ze,a as Ie,s as ht,e as Me,u as dt,d as an,o as It,b as Tt}from"./Footer.BPvCKlXl.js";import{b as Tn}from"./entry.B5z_eDGK.js";function Mn(n,e){const t={},s={},i={$$scope:1};let o=n.length;for(;o--;){const r=n[o],l=e[o];if(l){for(const u in r)u in l||(s[u]=1);for(const u in l)i[u]||(t[u]=l[u],i[u]=1);n[o]=l}else for(const u in r)i[u]=1}for(const r in s)r in t||(t[r]=void 0);return t}const Sn=()=>{};Promise.resolve();const Rn=(n,e)=>{n[e]=n[n.length-1],n.pop()};class An extends Error{constructor(e,t=`Unreachable case: ${e}`){super(t)}}let Nn=0,Ne=class fn{constructor(e,t,s=e,i=t,o=Nn++){this.x=e,this.y=t,this.prevX=s,this.prevY=i,this.id=o}clone(e=!1){return new fn(this.x,this.y,this.prevX,this.prevY,e?this.id:void 0)}moveTo(e,t){return this.prevX=this.x,this.prevY=this.y,this.x=e,this.y=t,this}moveBy(e,t){return this.moveTo(this.x+e,this.y+t),this}moveDir(e){switch(e){case"left":return this.moveBy(-1,0);case"right":return this.moveBy(1,0);case"up":return this.moveBy(0,-1);case"down":return this.moveBy(0,1);default:throw new Error("Unknown movement direction "+e)}}isOutOfBounds(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}isCollidingWith(e){return this.isAt(e.x,e.y)}isAt(e,t){return this.x===e&&this.y===t}};const hn=["left","right","up","down"],Hn=["up","down"],On=["left","right"],Mt=(n,e,t,s)=>{const i=t-n,o=s-e;if(!(i===0&&o===0))return Math.abs(i)>Math.abs(o)?i>0?"right":"left":o>0?"down":"up"},St=(n,e)=>n==="up"?e==="down":n==="down"?e==="up":n==="left"?e==="right":e==="left",ki=(n,e)=>{Un(n);const t=e.beginUpdate(n),s=e.nextMovementCommand();return s&&Kn(t,e,s),Yn(t,e),zn(t,e),Qn(t,e),t},Un=n=>{if(!n.snakeSegments.length)throw Error("state.snakeSegments cannot be empty")},yi=n=>(console.log("initGameState",n),n.apples=[new Ne(1,3),new Ne(7,2),new Ne(5,9)],n.snakeSegments=[new Ne(4,4),new Ne(4,5),new Ne(5,5),new Ne(5,6)],n),dn=(n,e,t)=>{for(const s of n.apples)if(s.isAt(e,t))return s;for(const s of n.snakeSegments)if(s.isAt(e,t))return s},mn=(n,e=50)=>{let t=0;for(;t<e;){t++;const s=Vn(n);if(!dn(n,s.x,s.y))return s}return null},Pn=()=>Ze(hn),Wn=n=>Ze(n==="up"||n==="down"?On:Hn),Bn=n=>n==="up"?"down":n==="down"?"up":n==="left"?"right":"left",wi=(n,e=mn(n))=>{if(!e)return null;const t=Pn(),s=Ge(n,e,t);if(!s)return null;const i=Wn(t),o=Ge(n,s,i);if(!o)return null;const l=Ge(n,o,t);if(!l)return null;const u=Bn(i),c=Ge(n,l,u);if(!c)return null;const a=Ge(n,c,u);return a?[e,s,o,l,c,a]:null},Di=(n,e,t)=>{const s=kt(n,e);for(s.length>t&&(s.length=t);s.length<t;){const i=n.apples[n.apples.length-1]||n.snakeSegments[0],o=hn.slice();let r=!1;for(;o.length;){const u=Ze(o),c=Ge(n,i,u);if(c){s.push(new Ne(c.x,c.y)),r=!0;break}Rn(o,o.indexOf(u))}if(r)continue;const l=Xn(n,i);if(!l)return!1;s.push(new Ne(l.x,l.y))}return!0},Ge=(n,e,t)=>_n(n,qn(e.x,t),Ln(e.y,t)),_n=(n,e,t)=>e<0||e>=n.mapWidth||t<0||t>=n.mapHeight||dn(n,e,t)?null:{x:e,y:t},Xn=(n,e)=>{let{x:t,y:s}=e,i=t,o=s,r=t,l=s,u="up";do{switch(u){case"up":{s-=1,s<l&&(u="right",l=s);break}case"right":{t+=1,t>i&&(u="down",i=t);break}case"down":{s+=1,s>o&&(u="left",o=s);break}case"left":{t-=1,t<r&&(u="up",r=t);break}default:throw new An(u)}const c=_n(n,t,s);if(c)return c}while(r>=0||l>=0||i<n.mapWidth||o<n.mapHeight);return null},qn=(n,e)=>e==="left"?n-1:e==="right"?n+1:n,Ln=(n,e)=>e==="up"?n-1:e==="down"?n+1:n,Vn=({mapWidth:n,mapHeight:e})=>({x:Ie(0,n-1),y:Ie(0,e-1)}),Kn=(n,e,t)=>{const s=gn(n,e);s[0]=Rt(n,e,0).moveDir(t);for(let i=1;i<s.length;i++){const{prevX:o,prevY:r}=s[i-1];s[i]=Rt(n,e,i).moveTo(o,r)}},Yn=(n,e)=>{const{snakeSegments:t,mapWidth:s,mapHeight:i}=n;t[0].isOutOfBounds(s,i)&&e.emit({name:"snake_collide_bounds"})},zn=(n,e)=>{const{snakeSegments:t}=n,s=t[0];for(let i=1;i<t.length;i++){const o=t[i];o.isCollidingWith(s)&&e.emit({name:"snake_collide_self",segment:o})}},Qn=(n,e)=>{const{snakeSegments:t,apples:s}=n,i=t[0];for(const o of s)if(i.isCollidingWith(o))return Gn(n,e,o)},Gn=(n,e,t)=>{const s=kt(n,e),i=gn(n,e);e.emit({name:"eat_apple",apple:t}),s.splice(s.indexOf(t),1);const o=i.at(-1),r=o.clone();r.moveTo(o.prevX,o.prevY),i.push(r),e.helpers.spawnApples(n,e)},Fn=(n,e)=>{const t=mn(n);if(!t)return;const s=new Ne(t.x,t.y);kt(n,e).push(s)},kt=(n,e)=>{var t;return n.apples===((t=e==null?void 0:e.prevState)==null?void 0:t.apples)?n.apples=n.apples.slice():n.apples},gn=(n,e)=>{var t;return n.snakeSegments===((t=e.prevState)==null?void 0:t.snakeSegments)?n.snakeSegments=n.snakeSegments.slice():n.snakeSegments},Rt=(n,e,t)=>{var s;return n.snakeSegments[t]===((s=e.prevState)==null?void 0:s.snakeSegments[t])?n.snakeSegments[t]=n.snakeSegments[t].clone(!0):n.snakeSegments[t]};function jn(n,e,t){let s,i=M,o=()=>(i(),i=K(N,T=>t(29,s=T)),N),r,l=M,u=()=>(l(),l=K(ee,T=>t(30,r=T)),ee),c,a=M,f=()=>(a(),a=K($,T=>t(31,c=T)),$),h,k=M,_=()=>(k(),k=K(ie,T=>t(32,h=T)),ie),C,S=M,y=()=>(S(),S=K(oe,T=>t(33,C=T)),oe),I,m=M,d=()=>(m(),m=K(le,T=>t(34,I=T)),le),b,p=M,H=()=>(p(),p=K(J,T=>t(35,b=T)),J);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>a()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>S()),n.$$.on_destroy.push(()=>m()),n.$$.on_destroy.push(()=>p());let{storageKey:B}=e,{toInitialState:P}=e,{toInitialEvents:Z=()=>[]}=e,{toInitialMovementDirection:se=()=>null}=e,{shouldStart:ce=()=>!0}=e,{tick:G}=e,{onReset:x=Sn}=e,{spawnApples:re=void 0}=e,{prevState:ne=void 0}=e;const $=ke(P());f();const oe=ke(Z());y();const ve={spawnApples:Fn},J=ke(0);H();const N=ke(se());o();const ee=ke([]);u();const le=ke(0);d();const ie=ke("ready");_();const Ke=T=>(te(oe,C=[],C),t(7,ne=T),{...T}),me=()=>{G()&&te(J,b++,b)},_e=()=>{te(ie,h="ready",h),te(oe,C=[],C),te(J,b=0,b),te(N,s=se(),s),te(ee,r=[],r),te(le,I++,I),t(7,ne=void 0),x(),te($,c=P(),c)},Pe=T=>{C.push(T)},Se=T=>{te(ie,h=T,h)},Re=()=>h==="playing"||!ce()?!1:(te(ie,h="playing",h),!0),O=4,Ye=()=>{const T=r.at(-1);if(T)return T;const be=c.snakeSegments[0];return Mt(be.prevX,be.prevY,be.x,be.y)},ze=T=>{const be=Ye();be!==void 0&&St(be,T)||ee.update(We=>{const W=We.concat(T);for(;W.length>O;)W.shift();return W})},Ce=T=>{r.length&&te(ee,r=[],r),ze(T)},Oe=()=>{te(N,s=null,s),r.length&&te(ee,r=[],r)},et=()=>{if(r.length){const T=r.slice();te(N,s=T.shift(),s),te(ee,r=T,r)}return s},ge=(T,be,We,W)=>{const z=Ye();let Ae=Mt(T,be,We,W);Ae&&(z!==void 0&&St(z,Ae)&&(Ae==="up"||Ae==="down"?Ae=We>T?"right":"left":Ae=W<be?"up":"down"),Ce(Ae))};return n.$$set=T=>{"storageKey"in T&&t(9,B=T.storageKey),"toInitialState"in T&&t(10,P=T.toInitialState),"toInitialEvents"in T&&t(11,Z=T.toInitialEvents),"toInitialMovementDirection"in T&&t(12,se=T.toInitialMovementDirection),"shouldStart"in T&&t(13,ce=T.shouldStart),"tick"in T&&t(14,G=T.tick),"onReset"in T&&t(15,x=T.onReset),"spawnApples"in T&&t(16,re=T.spawnApples),"prevState"in T&&t(7,ne=T.prevState)},n.$$.update=()=>{n.$$.dirty[0]&65536&&re&&t(8,ve.spawnApples=re,ve)},[$,oe,J,N,ee,le,ie,ne,ve,B,P,Z,se,ce,G,x,re,Ke,me,_e,Pe,Se,Re,O,ze,Ce,Oe,et,ge]}class Ei extends F{constructor(e){super(),j(this,e,jn,null,Q,{storageKey:9,toInitialState:10,toInitialEvents:11,toInitialMovementDirection:12,shouldStart:13,tick:14,onReset:15,spawnApples:16,prevState:7,state:0,events:1,helpers:8,tickCount:2,movementDirection:3,movementCommandQueue:4,runCount:5,status:6,beginUpdate:17,nextTick:18,reset:19,emit:20,end:21,start:22,MOVEMENT_COMMAND_QUEUE_SIZE:23,enqueueMovementCommand:24,setMovementCommand:25,resetMovementCommands:26,nextMovementCommand:27,handlePointerInput:28},null,[-1,-1])}get storageKey(){return this.$$.ctx[9]}set storageKey(e){this.$$set({storageKey:e}),He()}get toInitialState(){return this.$$.ctx[10]}set toInitialState(e){this.$$set({toInitialState:e}),He()}get toInitialEvents(){return this.$$.ctx[11]}set toInitialEvents(e){this.$$set({toInitialEvents:e}),He()}get toInitialMovementDirection(){return this.$$.ctx[12]}set toInitialMovementDirection(e){this.$$set({toInitialMovementDirection:e}),He()}get shouldStart(){return this.$$.ctx[13]}set shouldStart(e){this.$$set({shouldStart:e}),He()}get tick(){return this.$$.ctx[14]}set tick(e){this.$$set({tick:e}),He()}get onReset(){return this.$$.ctx[15]}set onReset(e){this.$$set({onReset:e}),He()}get spawnApples(){return this.$$.ctx[16]}set spawnApples(e){this.$$set({spawnApples:e}),He()}get prevState(){return this.$$.ctx[7]}set prevState(e){this.$$set({prevState:e}),He()}get state(){return this.$$.ctx[0]}get events(){return this.$$.ctx[1]}get helpers(){return this.$$.ctx[8]}get tickCount(){return this.$$.ctx[2]}get movementDirection(){return this.$$.ctx[3]}get movementCommandQueue(){return this.$$.ctx[4]}get runCount(){return this.$$.ctx[5]}get status(){return this.$$.ctx[6]}get beginUpdate(){return this.$$.ctx[17]}get nextTick(){return this.$$.ctx[18]}get reset(){return this.$$.ctx[19]}get emit(){return this.$$.ctx[20]}get end(){return this.$$.ctx[21]}get start(){return this.$$.ctx[22]}get MOVEMENT_COMMAND_QUEUE_SIZE(){return this.$$.ctx[23]}get enqueueMovementCommand(){return this.$$.ctx[24]}get setMovementCommand(){return this.$$.ctx[25]}get resetMovementCommands(){return this.$$.ctx[26]}get nextMovementCommand(){return this.$$.ctx[27]}get handlePointerInput(){return this.$$.ctx[28]}}const xn=n=>{if(!n)return!1;const{tagName:e}=n;if(e==="INPUT"){const{type:t}=n;return t==="text"||t==="number"||t==="password"||t==="email"||t==="search"||t==="url"}return e==="TEXTAREA"||n.contentEditable==="true"},Be=(n,e=!0,t=!0)=>(t&&n.preventDefault(),e?n.stopImmediatePropagation():n.stopPropagation(),n);function Jn(n){let e,t,s,i;const o=n[14].default,r=Xe(o,n,n[13],null);return{c(){e=D("div"),r&&r.c(),this.h()},l(l){e=E(l,"DIV",{class:!0,tabindex:!0,role:!0});var u=R(e);r&&r.l(u),u.forEach(w),this.h()},h(){g(e,"class","surface svelte-1ktoghv"),g(e,"tabindex","0"),g(e,"role","button")},m(l,u){U(l,e,u),r&&r.m(e,null),n[15](e),t=!0,s||(i=[X(e,"pointerdown",n[1]),X(e,"pointerup",n[2]),X(e,"pointermove",n[3]),X(e,"pointerenter",n[4]),X(e,"pointerleave",n[5]),X(e,"pointercancel",n[6])],s=!0)},p(l,[u]){r&&r.p&&(!t||u&8192)&&qe(r,o,l,l[13],t?Ve(o,l[13],u,null):Le(l[13]),null)},i(l){t||(q(r,l),t=!0)},o(l){Y(r,l),t=!1},d(l){l&&w(e),r&&r.d(l),n[15](null),s=!1,$e(i)}}}function Zn(n,e,t){let{$$slots:s={},$$scope:i}=e,{scale:o=1}=e,{pointing:r=void 0}=e,{pointerDown:l=void 0}=e,{pointerX:u=void 0}=e,{pointerY:c=void 0}=e,{cancelOnLeave:a=!0}=e;const f=(p,H)=>{const B=I.getBoundingClientRect();t(9,u=(p-B.left)/o),t(10,c=(H-B.top)/o)},h=p=>{p.shiftKey||p.button>=3||(Be(p),f(p.clientX,p.clientY),t(8,l=!0),m())},k=p=>{p.shiftKey||p.button>=3||(Be(p),f(p.clientX,p.clientY),t(8,l=!1))},_=p=>{p.shiftKey||(Be(p),f(p.clientX,p.clientY))},C=p=>{p.shiftKey||(Be(p),f(p.clientX,p.clientY),t(7,r=!0))},S=p=>{p.shiftKey||(Be(p),f(p.clientX,p.clientY),t(7,r=!1),a&&l&&(t(8,l=!1),d()))},y=p=>{p.shiftKey||(Be(p),l&&(t(8,l=!1),d()))};let I;const m=()=>{document.activeElement!==I&&I.focus()},d=()=>{document.activeElement===I&&I.blur()};function b(p){Fe[p?"unshift":"push"](()=>{I=p,t(0,I)})}return n.$$set=p=>{"scale"in p&&t(11,o=p.scale),"pointing"in p&&t(7,r=p.pointing),"pointerDown"in p&&t(8,l=p.pointerDown),"pointerX"in p&&t(9,u=p.pointerX),"pointerY"in p&&t(10,c=p.pointerY),"cancelOnLeave"in p&&t(12,a=p.cancelOnLeave),"$$scope"in p&&t(13,i=p.$$scope)},[I,h,k,_,C,S,y,r,l,u,c,o,a,i,s,b]}class $n extends F{constructor(e){super(),j(this,e,Zn,Jn,Q,{scale:11,pointing:7,pointerDown:8,pointerX:9,pointerY:10,cancelOnLeave:12})}}const es=(n={})=>{let e,t;const{subscribe:s,set:i,update:o}=ke({running:n.running??!1,time:n.time??0,dt:n.dt??0},()=>(gt(c).running&&l(),()=>u())),r=a=>{if(e!==void 0){const f=a-e;o(h=>({running:h.running,time:h.time+f,dt:f}))}e=a,t=requestAnimationFrame(r)},l=()=>{t&&u(),e=void 0,t=requestAnimationFrame(r)},u=()=>{t&&(cancelAnimationFrame(t),t=void 0)},c={subscribe:s,set:i,update:o,resume:()=>{o(a=>a.running?a:(l(),{running:!0,time:a.time,dt:a.dt}))},pause:()=>{o(a=>a.running?(u(),{running:!1,time:a.time,dt:a.dt}):a)},toggle:()=>{gt(c).running?c.pause():c.resume()},reset:()=>{o(a=>({running:a.running,time:0,dt:0}))}};return c},bn=Symbol("clock"),yt=()=>un(bn),Ci=(n=es())=>(ln(bn,n),n);function ts(n){let e,t,s="paused",i,o,r="paused",l,u,c,a;return{c(){e=D("div"),t=D("button"),t.textContent=s,i=L(),o=D("button"),o.textContent=r,this.h()},l(f){e=E(f,"DIV",{class:!0});var h=R(e);t=E(h,"BUTTON",{title:!0,"data-svelte-h":!0}),ue(t)!=="svelte-3p5h5c"&&(t.textContent=s),i=V(h),o=E(h,"BUTTON",{title:!0,"data-svelte-h":!0}),ue(o)!=="svelte-1gn4gu3"&&(o.textContent=r),h.forEach(w),this.h()},h(){g(t,"title","[Backtick `] unpause"),A(t,"position","relative"),A(t,"top","-110px"),A(t,"left","50px"),g(o,"title","[Backtick `] unpause"),A(o,"position","relative"),A(o,"top","25px"),A(o,"left","-90px"),g(e,"class","instructions svelte-1b70uot")},m(f,h){U(f,e,h),v(e,t),v(e,i),v(e,o),u=!0,c||(a=[X(t,"click",n[1]),X(o,"click",n[2])],c=!0)},p:M,i(f){u||(f&&vt(()=>{u&&(l||(l=Et(e,ht,{},!0)),l.run(1))}),u=!0)},o(f){f&&(l||(l=Et(e,ht,{},!1)),l.run(0)),u=!1},d(f){f&&w(e),f&&l&&l.end(),c=!1,$e(a)}}}function ns(n){const e=yt();return[e,()=>e.resume(),()=>e.resume()]}class ss extends F{constructor(e){super(),j(this,e,ns,ts,Q,{})}}const is=n=>({}),At=n=>({});function Nt(n){let e,t;return e=new ss({}),{c(){ye(e.$$.fragment)},l(s){we(e.$$.fragment,s)},m(s,i){De(e,s,i),t=!0},i(s){t||(q(e.$$.fragment,s),t=!0)},o(s){Y(e.$$.fragment,s),t=!1},d(s){Ee(e,s)}}}function rs(n){let e,t,s,i,o,r,l,u,c,a;const f=n[7].default,h=Xe(f,n,n[6],null);function k(d){n[8](d)}function _(d){n[9](d)}function C(d){n[10](d)}let S={};n[0]!==void 0&&(S.pointerDown=n[0]),n[1]!==void 0&&(S.pointerX=n[1]),n[2]!==void 0&&(S.pointerY=n[2]),i=new $n({props:S}),Fe.push(()=>ft(i,"pointerDown",k)),Fe.push(()=>ft(i,"pointerX",_)),Fe.push(()=>ft(i,"pointerY",C));const y=n[7].overlay,I=Xe(y,n,n[6],At);let m=!n[3]&&Nt();return{c(){e=D("div"),h&&h.c(),t=L(),s=D("div"),ye(i.$$.fragment),u=L(),I&&I.c(),c=L(),m&&m.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var b=R(e);h&&h.l(b),t=V(b),s=E(b,"DIV",{class:!0});var p=R(s);we(i.$$.fragment,p),p.forEach(w),u=V(b),I&&I.l(b),c=V(b),m&&m.l(b),b.forEach(w),this.h()},h(){g(s,"class","interactive-surface-wrapper svelte-1fdql2u"),g(e,"class","gamespace svelte-1fdql2u")},m(d,b){U(d,e,b),h&&h.m(e,null),v(e,t),v(e,s),De(i,s,null),v(e,u),I&&I.m(e,null),v(e,c),m&&m.m(e,null),a=!0},p(d,[b]){h&&h.p&&(!a||b&64)&&qe(h,f,d,d[6],a?Ve(f,d[6],b,null):Le(d[6]),null);const p={};!o&&b&1&&(o=!0,p.pointerDown=d[0],at(()=>o=!1)),!r&&b&2&&(r=!0,p.pointerX=d[1],at(()=>r=!1)),!l&&b&4&&(l=!0,p.pointerY=d[2],at(()=>l=!1)),i.$set(p),I&&I.p&&(!a||b&64)&&qe(I,y,d,d[6],a?Ve(y,d[6],b,is):Le(d[6]),At),d[3]?m&&(je(),Y(m,1,1,()=>{m=null}),xe()):m?b&8&&q(m,1):(m=Nt(),m.c(),q(m,1),m.m(e,null))},i(d){a||(q(h,d),q(i.$$.fragment,d),q(I,d),q(m),a=!0)},o(d){Y(h,d),Y(i.$$.fragment,d),Y(I,d),Y(m),a=!1},d(d){d&&w(e),h&&h.d(d),Ee(i),I&&I.d(d),m&&m.d()}}}function os(n,e,t){let s,i,{$$slots:o={},$$scope:r}=e,{pointerDown:l=!1}=e,{pointerX:u=void 0}=e,{pointerY:c=void 0}=e;const a=yt();mt(n,a,_=>t(5,i=_));function f(_){l=_,t(0,l)}function h(_){u=_,t(1,u)}function k(_){c=_,t(2,c)}return n.$$set=_=>{"pointerDown"in _&&t(0,l=_.pointerDown),"pointerX"in _&&t(1,u=_.pointerX),"pointerY"in _&&t(2,c=_.pointerY),"$$scope"in _&&t(6,r=_.$$scope)},n.$$.update=()=>{n.$$.dirty&32&&t(3,{running:s}=i,s)},[l,u,c,s,a,i,r,o,f,h,k]}class Ii extends F{constructor(e){super(),j(this,e,os,rs,Q,{pointerDown:0,pointerX:1,pointerY:2})}}const ls=.38196601125010515,us=.2360679774997897,pn=Symbol("currentTickDuration"),Ti=n=>ln(pn,n),cs=()=>un(pn);function as(n){let e,t,s=`translate3d(${n[3]}px, ${n[2]}px, 0)`;return{c(){e=D("div"),this.h()},l(i){e=E(i,"DIV",{class:!0}),R(e).forEach(w),this.h()},h(){g(e,"class",t="Entity "+n[1]+" svelte-1vc0oeg"),A(e,"transform",s),A(e,"z-index",1e3+n[0]),A(e,"--transition_duration",n[4])},m(i,o){U(i,e,o)},p(i,[o]){o&2&&t!==(t="Entity "+i[1]+" svelte-1vc0oeg")&&g(e,"class",t),o&12&&s!==(s=`translate3d(${i[3]}px, ${i[2]}px, 0)`)&&A(e,"transform",s),o&1&&A(e,"z-index",1e3+i[0]),o&16&&A(e,"--transition_duration",i[4])},i:M,o:M,d(i){i&&w(e)}}}const fs=100;function hs(n,e,t){let s,i,o,r,{x:l}=e,{y:u}=e,{width:c}=e,{height:a}=e,{classes:f="plain"}=e;const h=us,k=cs();return mt(n,k,_=>t(9,r=_)),n.$$set=_=>{"x"in _&&t(6,l=_.x),"y"in _&&t(0,u=_.y),"width"in _&&t(7,c=_.width),"height"in _&&t(8,a=_.height),"classes"in _&&t(1,f=_.classes)},n.$$.update=()=>{n.$$.dirty&512&&t(4,s=r===void 0?fs:r*h),n.$$.dirty&192&&t(3,i=l*c),n.$$.dirty&257&&t(2,o=u*a)},[u,f,o,i,s,k,l,c,a,r]}class ds extends F{constructor(e){super(),j(this,e,hs,as,Q,{x:6,y:0,width:7,height:8,classes:1})}}function ms(n){let e,t,s,i,o=`${n[1]}px`,r=`${n[2]}px`,l=`translate3d(${n[5]}px, ${n[4]}px, 0)`,u;return{c(){e=D("div"),this.h()},l(c){e=E(c,"DIV",{class:!0}),R(e).forEach(w),this.h()},h(){g(e,"class",t="apple entity "+n[3]+" svelte-hpbfm"),A(e,"width",o),A(e,"height",r),A(e,"transform",l),A(e,"z-index",1e3+n[0])},m(c,a){U(c,e,a),u=!0},p(c,[a]){(!u||a&8&&t!==(t="apple entity "+c[3]+" svelte-hpbfm"))&&g(e,"class",t),a&2&&o!==(o=`${c[1]}px`)&&A(e,"width",o),a&4&&r!==(r=`${c[2]}px`)&&A(e,"height",r),a&48&&l!==(l=`translate3d(${c[5]}px, ${c[4]}px, 0)`)&&A(e,"transform",l),a&1&&A(e,"z-index",1e3+c[0])},i(c){u||(c&&vt(()=>{u&&(i&&i.end(1),s=En(e,ht,{duration:630}),s.start())}),u=!0)},o(c){s&&s.invalidate(),c&&(i=Cn(e,ht,{duration:250})),u=!1},d(c){c&&w(e),c&&i&&i.end()}}}function _s(n,e,t){let s,i,{x:o}=e,{y:r}=e,{width:l}=e,{height:u}=e,{classes:c="plain"}=e;return n.$$set=a=>{"x"in a&&t(6,o=a.x),"y"in a&&t(0,r=a.y),"width"in a&&t(1,l=a.width),"height"in a&&t(2,u=a.height),"classes"in a&&t(3,c=a.classes)},n.$$.update=()=>{n.$$.dirty&66&&t(5,s=o*l),n.$$.dirty&5&&t(4,i=r*u)},[r,l,u,c,i,s,o]}class gs extends F{constructor(e){super(),j(this,e,_s,ms,Q,{x:6,y:0,width:1,height:2,classes:3})}}function Ht(n,e,t){const s=n.slice();return s[2]=e[t],s[4]=t,s}function Ot(n,e,t){const s=n.slice();return s[2]=e[t],s[6]=t,s}function Ut(n,e){let t;return{key:n,first:null,c(){t=D("div"),this.h()},l(s){t=E(s,"DIV",{class:!0}),R(t).forEach(w),this.h()},h(){g(t,"class","tile svelte-3bvcpc"),A(t,"--x",e[4]),A(t,"--y",e[6]),this.first=t},m(s,i){U(s,t,i)},p(s,i){e=s,i&1&&A(t,"--x",e[4]),i&2&&A(t,"--y",e[6])},d(s){s&&w(t)}}}function Pt(n,e){let t,s=[],i=new Map,o,r=Me({length:e[1]});const l=u=>u[4]+":"+u[6];for(let u=0;u<r.length;u+=1){let c=Ot(e,r,u),a=l(c);i.set(a,s[u]=Ut(a,c))}return{key:n,first:null,c(){t=pe();for(let u=0;u<s.length;u+=1)s[u].c();o=pe(),this.h()},l(u){t=pe();for(let c=0;c<s.length;c+=1)s[c].l(u);o=pe(),this.h()},h(){this.first=t},m(u,c){U(u,t,c);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(u,c);U(u,o,c)},p(u,c){e=u,c&3&&(r=Me({length:e[1]}),s=dt(s,c,l,1,e,r,i,o.parentNode,an,Ut,o,Ot))},d(u){u&&(w(t),w(o));for(let c=0;c<s.length;c+=1)s[c].d(u)}}}function bs(n){let e=[],t=new Map,s,i=Me({length:n[0]});const o=r=>r[4];for(let r=0;r<i.length;r+=1){let l=Ht(n,i,r),u=o(l);t.set(u,e[r]=Pt(u,l))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();s=pe()},l(r){for(let l=0;l<e.length;l+=1)e[l].l(r);s=pe()},m(r,l){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(r,l);U(r,s,l)},p(r,[l]){l&3&&(i=Me({length:r[0]}),e=dt(e,l,o,1,r,i,t,s.parentNode,an,Pt,s,Ht))},i:M,o:M,d(r){r&&w(s);for(let l=0;l<e.length;l+=1)e[l].d(r)}}}function ps(n,e,t){let{mapWidth:s}=e,{mapHeight:i}=e;return n.$$set=o=>{"mapWidth"in o&&t(0,s=o.mapWidth),"mapHeight"in o&&t(1,i=o.mapHeight)},[s,i]}class vs extends F{constructor(e){super(),j(this,e,ps,bs,Q,{mapWidth:0,mapHeight:1})}}function Wt(n,e,t){const s=n.slice();return s[18]=e[t],s}function Bt(n,e,t){const s=n.slice();return s[21]=e[t],s}function Xt(n,e){let t,s,i;return s=new gs({props:{x:e[21].x,y:e[21].y,classes:"apple",width:e[1],height:e[0]}}),{key:n,first:null,c(){t=pe(),ye(s.$$.fragment),this.h()},l(o){t=pe(),we(s.$$.fragment,o),this.h()},h(){this.first=t},m(o,r){U(o,t,r),De(s,o,r),i=!0},p(o,r){e=o;const l={};r&32&&(l.x=e[21].x),r&32&&(l.y=e[21].y),r&2&&(l.width=e[1]),r&1&&(l.height=e[0]),s.$set(l)},i(o){i||(q(s.$$.fragment,o),i=!0)},o(o){Y(s.$$.fragment,o),i=!1},d(o){o&&w(t),Ee(s,o)}}}function qt(n,e){let t,s,i;return s=new ds({props:{x:e[18].x,y:e[18].y,width:e[1],height:e[0]}}),{key:n,first:null,c(){t=pe(),ye(s.$$.fragment),this.h()},l(o){t=pe(),we(s.$$.fragment,o),this.h()},h(){this.first=t},m(o,r){U(o,t,r),De(s,o,r),i=!0},p(o,r){e=o;const l={};r&4&&(l.x=e[18].x),r&4&&(l.y=e[18].y),r&2&&(l.width=e[1]),r&1&&(l.height=e[0]),s.$set(l)},i(o){i||(q(s.$$.fragment,o),i=!0)},o(o){Y(s.$$.fragment,o),i=!1},d(o){o&&w(t),Ee(s,o)}}}function ks(n){let e,t,s,i,o=[],r=new Map,l,u,c=[],a=new Map,f,h=`${n[1]}px`,k=`${n[0]}px`,_;s=new vs({props:{mapWidth:n[4],mapHeight:n[3]}});let C=Me(n[5]);const S=m=>m[21].id;for(let m=0;m<C.length;m+=1){let d=Bt(n,C,m),b=S(d);r.set(b,o[m]=Xt(b,d))}let y=Me(n[2]);const I=m=>m[18].id;for(let m=0;m<y.length;m+=1){let d=Wt(n,y,m),b=I(d);a.set(b,c[m]=qt(b,d))}return{c(){e=D("div"),t=D("div"),ye(s.$$.fragment),i=L();for(let m=0;m<o.length;m+=1)o[m].c();l=L(),u=D("div");for(let m=0;m<c.length;m+=1)c[m].c();this.h()},l(m){e=E(m,"DIV",{class:!0});var d=R(e);t=E(d,"DIV",{class:!0});var b=R(t);we(s.$$.fragment,b),i=V(b);for(let H=0;H<o.length;H+=1)o[H].l(b);l=V(b),u=E(b,"DIV",{class:!0});var p=R(u);for(let H=0;H<c.length;H+=1)c[H].l(p);p.forEach(w),b.forEach(w),d.forEach(w),this.h()},h(){g(u,"class",f="snake moving-"+n[8]+" svelte-1hx0z6d"),g(t,"class","layer svelte-1hx0z6d"),g(e,"class","renderer svelte-1hx0z6d"),A(e,"--entity_width",h),A(e,"--entity_height",k)},m(m,d){U(m,e,d),v(e,t),De(s,t,null),v(t,i);for(let b=0;b<o.length;b+=1)o[b]&&o[b].m(t,null);v(t,l),v(t,u);for(let b=0;b<c.length;b+=1)c[b]&&c[b].m(u,null);_=!0},p(m,[d]){const b={};d&16&&(b.mapWidth=m[4]),d&8&&(b.mapHeight=m[3]),s.$set(b),d&35&&(C=Me(m[5]),je(),o=dt(o,d,S,1,m,C,r,t,It,Xt,l,Bt),xe()),d&7&&(y=Me(m[2]),je(),c=dt(c,d,I,1,m,y,a,u,It,qt,null,Wt),xe()),(!_||d&256&&f!==(f="snake moving-"+m[8]+" svelte-1hx0z6d"))&&g(u,"class",f),d&2&&h!==(h=`${m[1]}px`)&&A(e,"--entity_width",h),d&1&&k!==(k=`${m[0]}px`)&&A(e,"--entity_height",k)},i(m){if(!_){q(s.$$.fragment,m);for(let d=0;d<C.length;d+=1)q(o[d]);for(let d=0;d<y.length;d+=1)q(c[d]);_=!0}},o(m){Y(s.$$.fragment,m);for(let d=0;d<o.length;d+=1)Y(o[d]);for(let d=0;d<c.length;d+=1)Y(c[d]);_=!1},d(m){m&&w(e),Ee(s);for(let d=0;d<o.length;d+=1)o[d].d();for(let d=0;d<c.length;d+=1)c[d].d()}}}function ys(n,e,t){let s,i,o,r,l,u,c,a,f,h,k,_,C=M,S=()=>(C(),C=K(s,P=>t(17,_=P)),s),y,I=M,m=()=>(I(),I=K(i,P=>t(8,y=P)),i);n.$$.on_destroy.push(()=>C()),n.$$.on_destroy.push(()=>I());let{game:d}=e,{width:b}=e,{height:p}=e,{snakeX:H=0}=e,{snakeY:B=0}=e;return n.$$set=P=>{"game"in P&&t(11,d=P.game),"width"in P&&t(12,b=P.width),"height"in P&&t(13,p=P.height),"snakeX"in P&&t(9,H=P.snakeX),"snakeY"in P&&t(10,B=P.snakeY)},n.$$.update=()=>{n.$$.dirty&2048&&S(t(7,{state:s,movementDirection:i}=d,s,m(t(6,i)))),n.$$.dirty&131072&&t(5,{apples:o,snakeSegments:r,mapWidth:l,mapHeight:u}=_,o,(t(2,r),t(17,_)),(t(4,l),t(17,_)),(t(3,u),t(17,_))),n.$$.dirty&4112&&t(1,c=b/l),n.$$.dirty&8200&&t(0,a=p/u),n.$$.dirty&4&&t(16,f=r[0]),n.$$.dirty&65536&&t(15,h=f.x),n.$$.dirty&65536&&t(14,k=f.y),n.$$.dirty&32770&&t(9,H=c*h+c/2),n.$$.dirty&16385&&t(10,B=a*k+a/2)},[a,c,r,u,l,o,i,s,y,H,B,d,b,p,k,h,f,_]}class Mi extends F{constructor(e){super(),j(this,e,ys,ks,Q,{game:11,width:12,height:13,snakeX:9,snakeY:10})}}const Si=(n,e)=>{let t=null;try{t=localStorage.getItem(n)}catch{}if(t)try{const s=JSON.parse(t);return e==null||e(s),s}catch{try{localStorage.removeItem(n)}catch{}}},Ri=(n,e)=>{try{e===void 0?localStorage.removeItem(n):localStorage.setItem(n,JSON.stringify(e))}catch{}},ws=n=>{try{localStorage.removeItem(n),window.location=window.location}catch{alert("failed to clear localStorage item -- you might be in a sandboxed iframe like the Svelte REPL")}},vn=n=>{confirm("permanently delete saved data?")&&ws(n)};function Ai(n){if(typeof n!="number"||Number.isNaN(n))throw Error()}function Ni(n){if(!n||typeof n!="object")throw Error()}function Ds(n){let e,t,s,i="reset saved data",o,r,l,u,c,a="baseTickDuration",f,h,k,_,C,S="tickDurationDecay",y,I,m,d,b,p="tickDurationMin",H,B,P,Z,se,ce="tickDurationMax",G,x,re,ne,$,oe,ve="mapWidth",J,N,ee,le,ie,Ke="mapHeight",me,_e,Pe,Se,Re,O,Ye,ze,Ce,Oe,et="aspectRatio",ge,T,be,We;return{c(){e=D("form"),t=D("section"),s=D("button"),s.textContent=i,o=L(),r=D("section"),l=D("fieldset"),u=D("label"),c=D("strong"),c.textContent=a,f=D("input"),h=D("input"),k=L(),_=D("label"),C=D("strong"),C.textContent=S,y=D("input"),I=D("input"),m=L(),d=D("label"),b=D("strong"),b.textContent=p,H=D("input"),B=D("input"),P=L(),Z=D("label"),se=D("strong"),se.textContent=ce,G=D("input"),x=D("input"),re=L(),ne=D("fieldset"),$=D("label"),oe=D("strong"),oe.textContent=ve,J=D("input"),N=D("input"),ee=L(),le=D("label"),ie=D("strong"),ie.textContent=Ke,me=D("input"),_e=D("input"),Pe=L(),Se=D("fieldset"),Re=D("label"),O=D("input"),Ye=he(" autoAspectRatio"),ze=L(),Ce=D("label"),Oe=D("strong"),Oe.textContent=et,ge=D("input"),T=D("input"),this.h()},l(W){e=E(W,"FORM",{class:!0});var z=R(e);t=E(z,"SECTION",{class:!0});var Ae=R(t);s=E(Ae,"BUTTON",{type:!0,title:!0,"data-svelte-h":!0}),ue(s)!=="svelte-1585rri"&&(s.textContent=i),Ae.forEach(w),o=V(z),r=E(z,"SECTION",{class:!0});var Qe=R(r);l=E(Qe,"FIELDSET",{});var Ue=R(l);u=E(Ue,"LABEL",{});var tt=R(u);c=E(tt,"STRONG",{"data-svelte-h":!0}),ue(c)!=="svelte-13ppk5s"&&(c.textContent=a),f=E(tt,"INPUT",{type:!0,min:!0,max:!0}),h=E(tt,"INPUT",{type:!0}),tt.forEach(w),k=V(Ue),_=E(Ue,"LABEL",{});var nt=R(_);C=E(nt,"STRONG",{"data-svelte-h":!0}),ue(C)!=="svelte-1lbpubx"&&(C.textContent=S),y=E(nt,"INPUT",{type:!0,min:!0,max:!0,step:!0}),I=E(nt,"INPUT",{type:!0}),nt.forEach(w),m=V(Ue),d=E(Ue,"LABEL",{});var st=R(d);b=E(st,"STRONG",{"data-svelte-h":!0}),ue(b)!=="svelte-1itmg0z"&&(b.textContent=p),H=E(st,"INPUT",{type:!0,min:!0,max:!0}),B=E(st,"INPUT",{type:!0}),st.forEach(w),P=V(Ue),Z=E(Ue,"LABEL",{});var it=R(Z);se=E(it,"STRONG",{"data-svelte-h":!0}),ue(se)!=="svelte-j4pyop"&&(se.textContent=ce),G=E(it,"INPUT",{type:!0,min:!0,max:!0}),x=E(it,"INPUT",{type:!0}),it.forEach(w),Ue.forEach(w),re=V(Qe),ne=E(Qe,"FIELDSET",{});var rt=R(ne);$=E(rt,"LABEL",{});var ot=R($);oe=E(ot,"STRONG",{"data-svelte-h":!0}),ue(oe)!=="svelte-1qj64oy"&&(oe.textContent=ve),J=E(ot,"INPUT",{type:!0,min:!0,max:!0,step:!0}),N=E(ot,"INPUT",{type:!0,min:!0,max:!0}),ot.forEach(w),ee=V(rt),le=E(rt,"LABEL",{});var lt=R(le);ie=E(lt,"STRONG",{"data-svelte-h":!0}),ue(ie)!=="svelte-19a6845"&&(ie.textContent=Ke),me=E(lt,"INPUT",{type:!0,min:!0,max:!0,step:!0}),_e=E(lt,"INPUT",{type:!0,min:!0,max:!0}),lt.forEach(w),rt.forEach(w),Pe=V(Qe),Se=E(Qe,"FIELDSET",{});var ut=R(Se);Re=E(ut,"LABEL",{class:!0});var _t=R(Re);O=E(_t,"INPUT",{type:!0}),Ye=de(_t," autoAspectRatio"),_t.forEach(w),ze=V(ut),Ce=E(ut,"LABEL",{});var ct=R(Ce);Oe=E(ct,"STRONG",{"data-svelte-h":!0}),ue(Oe)!=="svelte-1nmnhwv"&&(Oe.textContent=et),ge=E(ct,"INPUT",{type:!0,min:!0,max:!0,step:!0}),T=E(ct,"INPUT",{type:!0,min:!0,max:!0,step:!0}),ct.forEach(w),ut.forEach(w),Qe.forEach(w),z.forEach(w),this.h()},h(){g(s,"type","button"),g(s,"title","[0] clear local storage"),g(t,"class","svelte-1ck2kjr"),g(f,"type","range"),g(f,"min",0),g(f,"max",2e3),g(h,"type","number"),g(y,"type","range"),g(y,"min",0),g(y,"max",1),g(y,"step",.01),g(I,"type","number"),g(H,"type","range"),g(H,"min",zt),g(H,"max",Qt),g(B,"type","number"),g(G,"type","range"),g(G,"min",zt),g(G,"max",Qt),g(x,"type","number"),g(J,"type","range"),J.value=n[8],g(J,"min",Lt),g(J,"max",Vt),g(J,"step",1),g(N,"type","number"),N.value=n[8],g(N,"min",Lt),g(N,"max",Vt),g(me,"type","range"),me.value=n[7],g(me,"min",Kt),g(me,"max",Yt),g(me,"step",1),g(_e,"type","number"),_e.value=n[7],g(_e,"min",Kt),g(_e,"max",Yt),g(O,"type","checkbox"),g(Re,"class","row"),g(ge,"type","range"),ge.value=n[10],ge.disabled=n[15],g(ge,"min",Gt),g(ge,"max",Ft),g(ge,"step",jt),g(T,"type","number"),T.value=n[10],T.disabled=n[15],g(T,"min",Gt),g(T,"max",Ft),g(T,"step",jt),fe(Ce,"disabled",n[15]),g(r,"class","svelte-1ck2kjr"),g(e,"class","settings panel svelte-1ck2kjr")},m(W,z){U(W,e,z),v(e,t),v(t,s),v(e,o),v(e,r),v(r,l),v(l,u),v(u,c),v(u,f),ae(f,n[11]),v(u,h),ae(h,n[11]),v(l,k),v(l,_),v(_,C),v(_,y),ae(y,n[12]),v(_,I),ae(I,n[12]),v(l,m),v(l,d),v(d,b),v(d,H),ae(H,n[13]),v(d,B),ae(B,n[13]),v(l,P),v(l,Z),v(Z,se),v(Z,G),ae(G,n[14]),v(Z,x),ae(x,n[14]),v(r,re),v(r,ne),v(ne,$),v($,oe),v($,J),v($,N),v(ne,ee),v(ne,le),v(le,ie),v(le,me),v(le,_e),v(r,Pe),v(r,Se),v(Se,Re),v(Re,O),O.checked=n[15],v(Re,Ye),v(Se,ze),v(Se,Ce),v(Ce,Oe),v(Ce,ge),v(Ce,T),be||(We=[X(s,"click",n[20]),X(f,"change",n[21]),X(f,"input",n[21]),X(h,"input",n[22]),X(y,"change",n[23]),X(y,"input",n[23]),X(I,"input",n[24]),X(H,"change",n[25]),X(H,"input",n[25]),X(B,"input",n[26]),X(G,"change",n[27]),X(G,"input",n[27]),X(x,"input",n[28]),X(J,"input",n[16]),X(N,"input",n[16]),X(me,"input",n[17]),X(_e,"input",n[17]),X(O,"change",n[29]),X(ge,"input",n[18]),X(T,"input",n[18])],be=!0)},p(W,[z]){z&2048&&ae(f,W[11]),z&2048&&Te(h.value)!==W[11]&&ae(h,W[11]),z&4096&&ae(y,W[12]),z&4096&&Te(I.value)!==W[12]&&ae(I,W[12]),z&8192&&ae(H,W[13]),z&8192&&Te(B.value)!==W[13]&&ae(B,W[13]),z&16384&&ae(G,W[14]),z&16384&&Te(x.value)!==W[14]&&ae(x,W[14]),z&256&&(J.value=W[8]),z&256&&N.value!==W[8]&&(N.value=W[8]),z&128&&(me.value=W[7]),z&128&&_e.value!==W[7]&&(_e.value=W[7]),z&32768&&(O.checked=W[15]),z&1024&&(ge.value=W[10]),z&32768&&(ge.disabled=W[15]),z&1024&&T.value!==W[10]&&(T.value=W[10]),z&32768&&(T.disabled=W[15]),z&32768&&fe(Ce,"disabled",W[15])},i:M,o:M,d(W){W&&w(e),be=!1,$e(We)}}}const Lt=2,Vt=100,Kt=2,Yt=100,zt=5,Qt=2e3,Gt=.1,Ft=10,jt=.1;function Es(n,e,t){let s,i,o,r,l=M,u=()=>(l(),l=K($,O=>t(10,r=O)),$),c,a=M,f=()=>(a(),a=K(s,O=>t(19,c=O)),s),h,k=M,_=()=>(k(),k=K(ce,O=>t(11,h=O)),ce),C,S=M,y=()=>(S(),S=K(G,O=>t(12,C=O)),G),I,m=M,d=()=>(m(),m=K(x,O=>t(13,I=O)),x),b,p=M,H=()=>(p(),p=K(re,O=>t(14,b=O)),re),B,P=M,Z=()=>(P(),P=K(ne,O=>t(15,B=O)),ne);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>a()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>S()),n.$$.on_destroy.push(()=>m()),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>P());let{game:se}=e,{baseTickDuration:ce}=e;_();let{tickDurationDecay:G}=e;y();let{tickDurationMin:x}=e;d();let{tickDurationMax:re}=e;H();let{autoAspectRatio:ne}=e;Z();let{aspectRatio:$}=e;u();const oe=O=>te(s,c={...c,mapWidth:Number(O.target.value)|0},c),ve=O=>te(s,c={...c,mapHeight:Number(O.target.value)|0},c),J=O=>te($,r=Number(O.target.value),r),N=()=>vn(se.storageKey);function ee(){h=Te(this.value),ce.set(h)}function le(){h=Te(this.value),ce.set(h)}function ie(){C=Te(this.value),G.set(C)}function Ke(){C=Te(this.value),G.set(C)}function me(){I=Te(this.value),x.set(I)}function _e(){I=Te(this.value),x.set(I)}function Pe(){b=Te(this.value),re.set(b)}function Se(){b=Te(this.value),re.set(b)}function Re(){B=this.checked,ne.set(B)}return n.$$set=O=>{"game"in O&&t(0,se=O.game),"baseTickDuration"in O&&_(t(1,ce=O.baseTickDuration)),"tickDurationDecay"in O&&y(t(2,G=O.tickDurationDecay)),"tickDurationMin"in O&&d(t(3,x=O.tickDurationMin)),"tickDurationMax"in O&&H(t(4,re=O.tickDurationMax)),"autoAspectRatio"in O&&Z(t(5,ne=O.autoAspectRatio)),"aspectRatio"in O&&u(t(6,$=O.aspectRatio))},n.$$.update=()=>{n.$$.dirty&1&&f(t(9,{state:s}=se,s)),n.$$.dirty&524288&&t(8,{mapWidth:i,mapHeight:o}=c,i,(t(7,o),t(19,c)))},[se,ce,G,x,re,ne,$,o,i,s,r,h,C,I,b,B,oe,ve,J,c,N,ee,le,ie,Ke,me,_e,Pe,Se,Re]}class Hi extends F{constructor(e){super(),j(this,e,Es,Ds,Q,{game:0,baseTickDuration:1,tickDurationDecay:2,tickDurationMin:3,tickDurationMax:4,autoAspectRatio:5,aspectRatio:6})}}function xt(n,e,t){const s=n.slice();return s[14]=e[t],s}function Jt(n){let e,t=Me({length:n[0]}),s=[];for(let i=0;i<t.length;i+=1)s[i]=Zt(xt(n,t,i));return{c(){e=D("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=R(e);for(let r=0;r<s.length;r+=1)s[r].l(o);o.forEach(w),this.h()},h(){g(e,"class","burst svelte-1oqzh3p")},m(i,o){U(i,e,o);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(e,null)},p(i,o){if(o&4095){t=Me({length:i[0]});let r;for(r=0;r<t.length;r+=1){const l=xt(i,t,r);s[r]?s[r].p(l,o):(s[r]=Zt(l),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=t.length}},d(i){i&&w(e),cn(s,i)}}}function Zt(n){let e,t=Ze(n[1])+"",s,i,o=`${Ie(-n[2],n[2])}px`,r=`${Ie(-n[3],n[3])}px`,l=`${Ie(n[8],n[9])}deg`,u=`${Ie(n[10],n[11])}deg`,c=`${Ie(n[6],n[7])}deg`;return{c(){e=D("div"),s=he(t),i=L(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=R(e);s=de(f,t),i=V(f),f.forEach(w),this.h()},h(){g(e,"class","burst-item svelte-1oqzh3p"),A(e,"--target_x",o),A(e,"--target_y",r),A(e,"--scale",Tt(n[4],n[5])),A(e,"--start_rotation",l),A(e,"--end_rotation",u),A(e,"--hue_rotation",c)},m(a,f){U(a,e,f),v(e,s),v(e,i)},p(a,f){f&2&&t!==(t=Ze(a[1])+"")&&Je(s,t),f&4&&o!==(o=`${Ie(-a[2],a[2])}px`)&&A(e,"--target_x",o),f&8&&r!==(r=`${Ie(-a[3],a[3])}px`)&&A(e,"--target_y",r),f&48&&A(e,"--scale",Tt(a[4],a[5])),f&768&&l!==(l=`${Ie(a[8],a[9])}deg`)&&A(e,"--start_rotation",l),f&3072&&u!==(u=`${Ie(a[10],a[11])}deg`)&&A(e,"--end_rotation",u),f&192&&c!==(c=`${Ie(a[6],a[7])}deg`)&&A(e,"--hue_rotation",c)},d(a){a&&w(e)}}}function Cs(n){let e,t=!n[12]&&Jt(n);return{c(){t&&t.c(),e=pe()},l(s){t&&t.l(s),e=pe()},m(s,i){t&&t.m(s,i),U(s,e,i)},p(s,[i]){s[12]?t&&(t.d(1),t=null):t?t.p(s,i):(t=Jt(s),t.c(),t.m(e.parentNode,e))},i:M,o:M,d(s){s&&w(e),t&&t.d(s)}}}const Is=2e3;function Ts(n,e,t){let{count:s}=e,{items:i}=e,{xRadius:o=250}=e,{yRadius:r=250}=e,{scaleMin:l=ls}=e,{scaleMax:u=1}=e,{hueRotationMin:c=0}=e,{hueRotationMax:a=0}=e,{startRotationMin:f=0}=e,{startRotationMax:h=360}=e,{endRotationMin:k=0}=e,{endRotationMax:_=360}=e,C=!1,S;return yn(()=>(S=setTimeout(()=>t(12,C=!0),Is),()=>clearTimeout(S))),n.$$set=y=>{"count"in y&&t(0,s=y.count),"items"in y&&t(1,i=y.items),"xRadius"in y&&t(2,o=y.xRadius),"yRadius"in y&&t(3,r=y.yRadius),"scaleMin"in y&&t(4,l=y.scaleMin),"scaleMax"in y&&t(5,u=y.scaleMax),"hueRotationMin"in y&&t(6,c=y.hueRotationMin),"hueRotationMax"in y&&t(7,a=y.hueRotationMax),"startRotationMin"in y&&t(8,f=y.startRotationMin),"startRotationMax"in y&&t(9,h=y.startRotationMax),"endRotationMin"in y&&t(10,k=y.endRotationMin),"endRotationMax"in y&&t(11,_=y.endRotationMax)},[s,i,o,r,l,u,c,a,f,h,k,_,C]}class Ms extends F{constructor(e){super(),j(this,e,Ts,Cs,Q,{count:0,items:1,xRadius:2,yRadius:3,scaleMin:4,scaleMax:5,hueRotationMin:6,hueRotationMax:7,startRotationMin:8,startRotationMax:9,endRotationMin:10,endRotationMax:11})}}const Ss=()=>{const n=ke(!1);let e;return{subscribe:n.subscribe,updateKey:async t=>{if(t!==e){if(t===void 0){e=t;return}e=t,gt(n)&&(n.set(!1),await wn()),n.set(!0)}}}};function $t(n){let e=n[2],t,s,i=en(n);return{c(){i.c(),t=pe()},l(o){i.l(o),t=pe()},m(o,r){i.m(o,r),U(o,t,r),s=!0},p(o,r){r&4&&Q(e,e=o[2])?(je(),Y(i,1,1,M),xe(),i=en(o),i.c(),q(i,1),i.m(t.parentNode,t)):i.p(o,r)},i(o){s||(q(i),s=!0)},o(o){Y(i),s=!1},d(o){o&&w(t),i.d(o)}}}function en(n){let e,t,s;return t=new Ms({props:{count:15,items:n[1],xRadius:100,yRadius:100}}),{c(){e=D("div"),ye(t.$$.fragment),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=R(e);we(t.$$.fragment,o),o.forEach(w),this.h()},h(){g(e,"class","text-burst-wrapper svelte-c7uhk0")},m(i,o){U(i,e,o),De(t,e,null),s=!0},p(i,o){const r={};o&2&&(r.items=i[1]),t.$set(r)},i(i){s||(q(t.$$.fragment,i),s=!0)},o(i){Y(t.$$.fragment,i),s=!1},d(i){i&&w(e),Ee(t)}}}function Rs(n){let e,t,s,i,o,r;const l=n[6].default,u=Xe(l,n,n[5],null);let c=n[1]&&n[2]!==void 0&&$t(n);return{c(){e=D("div"),t=D("div"),u&&u.c(),s=L(),c&&c.c(),i=L(),o=D("div"),this.h()},l(a){e=E(a,"DIV",{class:!0,title:!0});var f=R(e);t=E(f,"DIV",{class:!0});var h=R(t);u&&u.l(h),h.forEach(w),s=V(f),c&&c.l(f),i=V(f),o=E(f,"DIV",{class:!0}),R(o).forEach(w),f.forEach(w),this.h()},h(){g(t,"class","value svelte-c7uhk0"),fe(t,"bounce",n[3]),g(o,"class","apple"),fe(o,"bounce",n[3]),g(e,"class","score svelte-c7uhk0"),g(e,"title",n[0])},m(a,f){U(a,e,f),v(e,t),u&&u.m(t,null),v(e,s),c&&c.m(e,null),v(e,i),v(e,o),r=!0},p(a,[f]){u&&u.p&&(!r||f&32)&&qe(u,l,a,a[5],r?Ve(l,a[5],f,null):Le(a[5]),null),(!r||f&8)&&fe(t,"bounce",a[3]),a[1]&&a[2]!==void 0?c?(c.p(a,f),f&6&&q(c,1)):(c=$t(a),c.c(),q(c,1),c.m(e,i)):c&&(je(),Y(c,1,1,()=>{c=null}),xe()),(!r||f&8)&&fe(o,"bounce",a[3]),(!r||f&1)&&g(e,"title",a[0])},i(a){r||(q(u,a),q(c),r=!0)},o(a){Y(u,a),Y(c),r=!1},d(a){a&&w(e),u&&u.d(a),c&&c.d()}}}function As(n,e,t){let s,{$$slots:i={},$$scope:o}=e,{title:r="score"}=e,{textBurstItems:l=["🍎","🍏"]}=e,{progressKey:u=void 0}=e;const c=Ss();return mt(n,c,a=>t(3,s=a)),n.$$set=a=>{"title"in a&&t(0,r=a.title),"textBurstItems"in a&&t(1,l=a.textBurstItems),"progressKey"in a&&t(2,u=a.progressKey),"$$scope"in a&&t(5,o=a.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&c.updateKey(u)},[r,l,u,s,c,o,i]}class Oi extends F{constructor(e){super(),j(this,e,As,Rs,Q,{title:0,textBurstItems:1,progressKey:2})}}function Ns(n,e,t){let s,{fps:i=0}=e;const o=yt();mt(n,o,c=>t(2,s=c));let r=0,l=0;const u=c=>{r+=c,l++,r>1e3&&(r-=1e3,t(1,i=l),l=0)};return n.$$set=c=>{"fps"in c&&t(1,i=c.fps)},n.$$.update=()=>{n.$$.dirty&4&&s.running&&u(s.dt)},[o,i,s]}class Hs extends F{constructor(e){super(),j(this,e,Ns,null,Q,{fps:1})}}function tn(n){let e,t,s=Math.round(n[2])+"",i,o,r,l,u,c=(n[3]??"??")+"",a,f;return{c(){e=D("li"),t=D("div"),i=he(s),o=he(`
			ms per tick`),r=L(),l=D("li"),u=D("div"),a=he(c),f=he(`
			frames per tick`),this.h()},l(h){e=E(h,"LI",{class:!0});var k=R(e);t=E(k,"DIV",{class:!0});var _=R(t);i=de(_,s),_.forEach(w),o=de(k,`
			ms per tick`),k.forEach(w),r=V(h),l=E(h,"LI",{class:!0});var C=R(l);u=E(C,"DIV",{class:!0});var S=R(u);a=de(S,c),S.forEach(w),f=de(C,`
			frames per tick`),C.forEach(w),this.h()},h(){g(t,"class","value svelte-xxp3cn"),g(e,"class","svelte-xxp3cn"),g(u,"class","value svelte-xxp3cn"),g(l,"class","svelte-xxp3cn")},m(h,k){U(h,e,k),v(e,t),v(t,i),v(e,o),U(h,r,k),U(h,l,k),v(l,u),v(u,a),v(l,f)},p(h,k){k&4&&s!==(s=Math.round(h[2])+"")&&Je(i,s),k&8&&c!==(c=(h[3]??"??")+"")&&Je(a,c)},d(h){h&&(w(e),w(r),w(l))}}}function Os(n){let e,t,s,i,o,r,l,u,c,a=(n[1]??"??")+"",f,h,k,_,C,S,y=n[2]&&tn(n);function I(d){n[7](d)}let m={};return n[1]!==void 0&&(m.fps=n[1]),_=new Hs({props:m}),Fe.push(()=>ft(_,"fps",I)),{c(){e=D("ul"),t=D("li"),s=D("div"),i=he(n[5]),o=he(`
		lives`),r=L(),y&&y.c(),l=L(),u=D("li"),c=D("div"),f=he(a),h=he(`
		fps`),k=L(),ye(_.$$.fragment),this.h()},l(d){e=E(d,"UL",{class:!0});var b=R(e);t=E(b,"LI",{class:!0});var p=R(t);s=E(p,"DIV",{class:!0});var H=R(s);i=de(H,n[5]),H.forEach(w),o=de(p,`
		lives`),p.forEach(w),r=V(b),y&&y.l(b),l=V(b),u=E(b,"LI",{class:!0});var B=R(u);c=E(B,"DIV",{class:!0});var P=R(c);f=de(P,a),P.forEach(w),h=de(B,`
		fps`),B.forEach(w),b.forEach(w),k=V(d),we(_.$$.fragment,d),this.h()},h(){g(s,"class","value svelte-xxp3cn"),g(t,"class","svelte-xxp3cn"),g(c,"class","value svelte-xxp3cn"),g(u,"class","svelte-xxp3cn"),g(e,"class","Stats svelte-xxp3cn")},m(d,b){U(d,e,b),v(e,t),v(t,s),v(s,i),v(t,o),v(e,r),y&&y.m(e,null),v(e,l),v(e,u),v(u,c),v(c,f),v(u,h),U(d,k,b),De(_,d,b),S=!0},p(d,[b]){(!S||b&32)&&Je(i,d[5]),d[2]?y?y.p(d,b):(y=tn(d),y.c(),y.m(e,l)):y&&(y.d(1),y=null),(!S||b&2)&&a!==(a=(d[1]??"??")+"")&&Je(f,a);const p={};!C&&b&2&&(C=!0,p.fps=d[1],at(()=>C=!1)),_.$set(p)},i(d){S||(q(_.$$.fragment,d),S=!0)},o(d){Y(_.$$.fragment,d),S=!1},d(d){d&&(w(e),w(k)),y&&y.d(),Ee(_,d)}}}function Us(n,e,t){let s,i,o,r=M,l=()=>(r(),r=K(h,C=>t(2,o=C)),h),u,c=M,a=()=>(c(),c=K(s,C=>t(5,u=C)),s);n.$$.on_destroy.push(()=>r()),n.$$.on_destroy.push(()=>c());let{game:f}=e,{tickDuration:h=void 0}=e;l();let k;function _(C){k=C,t(1,k)}return n.$$set=C=>{"game"in C&&t(6,f=C.game),"tickDuration"in C&&l(t(0,h=C.tickDuration))},n.$$.update=()=>{n.$$.dirty&64&&a(t(4,{runCount:s}=f,s)),n.$$.dirty&6&&t(3,i=k&&o&&Math.floor(o/(1e3/k)))},[h,k,o,i,s,u,f,_]}class Ui extends F{constructor(e){super(),j(this,e,Us,Os,Q,{game:6,tickDuration:0})}}const Pi=({mapWidth:n=16,mapHeight:e=16,apples:t=[],snakeSegments:s=[]}={})=>({mapWidth:n,mapHeight:e,apples:t,snakeSegments:s});function Ps(n,e,t){let s,i,o=M,r=()=>(o(),o=K(h,C=>t(7,i=C)),h),l,u=M,c=()=>(u(),u=K(a,C=>t(6,l=C)),a);n.$$.on_destroy.push(()=>o()),n.$$.on_destroy.push(()=>u());let{clock:a}=e;c();let{tick:f=void 0}=e,{tickDuration:h}=e;r();let{tickTimer:k=0}=e;const _=C=>{t(2,k+=C),k>=i&&(f==null||f(),t(2,k=0))};return n.$$set=C=>{"clock"in C&&c(t(0,a=C.clock)),"tick"in C&&t(3,f=C.tick),"tickDuration"in C&&r(t(1,h=C.tickDuration)),"tickTimer"in C&&t(2,k=C.tickTimer)},n.$$.update=()=>{n.$$.dirty&64&&t(5,{running:s}=l,s),n.$$.dirty&96&&s&&_(l.dt)},[a,h,k,f,_,s,l]}class Wi extends F{constructor(e){super(),j(this,e,Ps,null,Q,{clock:0,tick:3,tickDuration:1,tickTimer:2,update:4})}get update(){return this.$$.ctx[4]}}function Ws(n){let e;return{c(){e=he("▶️")},l(t){e=de(t,"▶️")},m(t,s){U(t,e,s)},d(t){t&&w(e)}}}function Bs(n){let e;return{c(){e=he("⏸")},l(t){e=de(t,"⏸")},m(t,s){U(t,e,s)},d(t){t&&w(e)}}}function Xs(n){let e,t,s;function i(l,u){return l[1]?Bs:Ws}let o=i(n),r=o(n);return{c(){e=D("button"),r.c(),this.h()},l(l){e=E(l,"BUTTON",{class:!0,title:!0});var u=R(e);r.l(u),u.forEach(w),this.h()},h(){g(e,"class","icon-button"),g(e,"title","[Backtick `] toggle clock")},m(l,u){U(l,e,u),r.m(e,null),t||(s=X(e,"click",n[3]),t=!0)},p(l,[u]){o!==(o=i(l))&&(r.d(1),r=o(l),r&&(r.c(),r.m(e,null)))},i:M,o:M,d(l){l&&w(e),r.d(),t=!1,s()}}}function qs(n,e,t){let s,i,o=M,r=()=>(o(),o=K(l,c=>t(2,i=c)),l);n.$$.on_destroy.push(()=>o());let{clock:l}=e;r();const u=()=>l.toggle();return n.$$set=c=>{"clock"in c&&r(t(0,l=c.clock))},n.$$.update=()=>{n.$$.dirty&4&&t(1,{running:s}=i,s)},[l,s,i,u]}class Ls extends F{constructor(e){super(),j(this,e,qs,Xs,Q,{clock:0})}}function Vs(n){let e,t,s="←",i,o,r,l="↑",u,c,a="↓",f,h,k="→",_,C;return{c(){e=D("div"),t=D("button"),t.textContent=s,i=L(),o=D("div"),r=D("button"),r.textContent=l,u=L(),c=D("button"),c.textContent=a,f=L(),h=D("button"),h.textContent=k,this.h()},l(S){e=E(S,"DIV",{class:!0});var y=R(e);t=E(y,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(t)!=="svelte-1uw86kj"&&(t.textContent=s),i=V(y),o=E(y,"DIV",{class:!0});var I=R(o);r=E(I,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(r)!=="svelte-5kh4je"&&(r.textContent=l),u=V(I),c=E(I,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(c)!=="svelte-bv82tn"&&(c.textContent=a),I.forEach(w),f=V(y),h=E(y,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ue(h)!=="svelte-e2ddd0"&&(h.textContent=k),y.forEach(w),this.h()},h(){g(t,"class","icon-button"),g(t,"title","queue move left [a, h, left arrow] [hold shift to end turn]"),fe(t,"selected",n[0]==="left"),g(r,"class","icon-button"),g(r,"title","queue move up [w, k, up arrow] [hold shift to end turn]"),fe(r,"selected",n[0]==="up"),g(c,"class","icon-button"),g(c,"title","queue move down [s, j, down arrow] [hold shift to end turn]"),fe(c,"selected",n[0]==="down"),g(o,"class","up-and-down svelte-1oazbcg"),g(h,"class","icon-button"),g(h,"title","queue move right [d, l, right arrow] [hold shift to end turn]"),fe(h,"selected",n[0]==="right"),g(e,"class","directional-controls svelte-1oazbcg")},m(S,y){U(S,e,y),v(e,t),v(e,i),v(e,o),v(o,r),v(o,u),v(o,c),v(e,f),v(e,h),_||(C=[X(t,"click",n[2]),X(r,"click",n[3]),X(c,"click",n[4]),X(h,"click",n[5])],_=!0)},p(S,[y]){y&1&&fe(t,"selected",S[0]==="left"),y&1&&fe(r,"selected",S[0]==="up"),y&1&&fe(c,"selected",S[0]==="down"),y&1&&fe(h,"selected",S[0]==="right")},i:M,o:M,d(S){S&&w(e),_=!1,$e(C)}}}function Ks(n,e,t){let{selectedDirection:s}=e,{select:i}=e;const o=()=>i("left"),r=()=>i("up"),l=()=>i("down"),u=()=>i("right");return n.$$set=c=>{"selectedDirection"in c&&t(0,s=c.selectedDirection),"select"in c&&t(1,i=c.select)},[s,i,o,r,l,u]}class Ys extends F{constructor(e){super(),j(this,e,Ks,Vs,Q,{selectedDirection:0,select:1})}}function nn(n,e,t){const s=n.slice();return s[5]=e[t],s}function sn(n){let e,t,s=n[5]+"",i;return{c(){e=D("li"),t=he("> "),i=he(s)},l(o){e=E(o,"LI",{});var r=R(e);t=de(r,"> "),i=de(r,s),r.forEach(w)},m(o,r){U(o,e,r),v(e,t),v(e,i)},p(o,r){r&2&&s!==(s=o[5]+"")&&Je(i,s)},d(o){o&&w(e)}}}function zs(n){let e,t=Me(n[1]),s=[];for(let i=0;i<t.length;i+=1)s[i]=sn(nn(n,t,i));return{c(){e=D("ul");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"UL",{class:!0});var o=R(e);for(let r=0;r<s.length;r+=1)s[r].l(o);o.forEach(w),this.h()},h(){g(e,"class","svelte-ahpkoh")},m(i,o){U(i,e,o);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(e,null)},p(i,[o]){if(o&2){t=Me(i[1]);let r;for(r=0;r<t.length;r+=1){const l=nn(i,t,r);s[r]?s[r].p(l,o):(s[r]=sn(l),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=t.length}},i:M,o:M,d(i){i&&w(e),cn(s,i)}}}function Qs(n,e,t){let s,i,o=M,r=()=>(o(),o=K(l,a=>t(3,i=a)),l);n.$$.on_destroy.push(()=>o());let{movementCommandQueue:l}=e;r();let{queueSize:u}=e;const c=(a,f)=>{const h=new Array(f);for(let k=0;k<f;k++){const _=a[k];_===void 0?h[k]=k===0?"...":"":h[k]=_}return h};return n.$$set=a=>{"movementCommandQueue"in a&&r(t(0,l=a.movementCommandQueue)),"queueSize"in a&&t(2,u=a.queueSize)},n.$$.update=()=>{n.$$.dirty&12&&t(1,s=c(i,u))},[l,s,u,i]}class Gs extends F{constructor(e){super(),j(this,e,Qs,zs,Q,{movementCommandQueue:0,queueSize:2})}}function Fs(n){let e,t;return{c:M,l:M,m(s,i){e||(t=X(window,"keydown",n[2],!0),e=!0)},p:M,i:M,o:M,d(s){e=!1,t()}}}function js(n,e,t){let{onKeydown:s}=e,{enabled:i=!0}=e;const o=r=>{i&&!xn(r.target)&&s(r.key,r.ctrlKey,r.altKey,r.shiftKey)&&Be(r)};return n.$$set=r=>{"onKeydown"in r&&t(0,s=r.onKeydown),"enabled"in r&&t(1,i=r.enabled)},[s,i,o]}class kn extends F{constructor(e){super(),j(this,e,js,Fs,Q,{onKeydown:0,enabled:1})}}function rn(n){let e,t,s;return t=new Gs({props:{movementCommandQueue:n[10],queueSize:n[8]}}),{c(){e=D("div"),ye(t.$$.fragment),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=R(e);we(t.$$.fragment,o),o.forEach(w),this.h()},h(){g(e,"class","p_md")},m(i,o){U(i,e,o),De(t,e,null),s=!0},p(i,o){const r={};o&1024&&(r.movementCommandQueue=i[10]),o&256&&(r.queueSize=i[8]),t.$set(r)},i(i){s||(q(t.$$.fragment,i),s=!0)},o(i){Y(t.$$.fragment,i),s=!1},d(i){i&&w(e),Ee(t)}}}function xs(n){let e,t,s,i,o,r,l,u="⏮",c,a,f,h,k="⏩",_,C,S,y,I;s=new Ys({props:{selectedDirection:n[3],select:n[13]}});let m=n[10]&&rn(n);return a=new Ls({props:{clock:n[0]}}),C=new kn({props:{onKeydown:n[14]}}),{c(){e=D("div"),t=D("div"),ye(s.$$.fragment),i=L(),m&&m.c(),o=L(),r=D("div"),l=D("button"),l.textContent=u,c=L(),ye(a.$$.fragment),f=L(),h=D("button"),h.textContent=k,_=L(),ye(C.$$.fragment),this.h()},l(d){e=E(d,"DIV",{class:!0});var b=R(e);t=E(b,"DIV",{class:!0});var p=R(t);we(s.$$.fragment,p),i=V(p),m&&m.l(p),p.forEach(w),o=V(b),r=E(b,"DIV",{class:!0});var H=R(r);l=E(H,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),ue(l)!=="svelte-1isc6q"&&(l.textContent=u),c=V(H),we(a.$$.fragment,H),f=V(H),h=E(H,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),ue(h)!=="svelte-2ef9vp"&&(h.textContent=k),H.forEach(w),b.forEach(w),_=V(d),we(C.$$.fragment,d),this.h()},h(){g(t,"class","box row"),g(l,"title","[r] restart game"),g(l,"class","icon-button"),g(h,"title","[1] next turn"),g(h,"class","icon-button"),g(r,"class","box row"),g(e,"class","controls panel svelte-1u1aha2")},m(d,b){U(d,e,b),v(e,t),De(s,t,null),v(t,i),m&&m.m(t,null),v(e,o),v(e,r),v(r,l),v(r,c),De(a,r,null),v(r,f),v(r,h),U(d,_,b),De(C,d,b),S=!0,y||(I=[X(l,"click",function(){wt(n[4])&&n[4].apply(this,arguments)}),X(h,"click",function(){wt(n[1])&&n[1].apply(this,arguments)})],y=!0)},p(d,[b]){n=d;const p={};b&8&&(p.selectedDirection=n[3]),b&512&&(p.select=n[13]),s.$set(p),n[10]?m?(m.p(n,b),b&1024&&q(m,1)):(m=rn(n),m.c(),q(m,1),m.m(t,null)):m&&(je(),Y(m,1,1,()=>{m=null}),xe());const H={};b&1&&(H.clock=n[0]),a.$set(H);const B={};b&2679&&(B.onKeydown=n[14]),C.$set(B)},i(d){S||(q(s.$$.fragment,d),q(m),q(a.$$.fragment,d),q(C.$$.fragment,d),S=!0)},o(d){Y(s.$$.fragment,d),Y(m),Y(a.$$.fragment,d),Y(C.$$.fragment,d),S=!1},d(d){d&&(w(e),w(_)),Ee(s),m&&m.d(),Ee(a),Ee(C,d),y=!1,$e(I)}}}function Js(n,e,t){let s,i,o,r,l,u,c,a,f,h=M,k=()=>(h(),h=K(s,p=>t(12,f=p)),s),_,C=M,S=()=>(C(),C=K(r,p=>t(11,_=p)),r);n.$$.on_destroy.push(()=>h()),n.$$.on_destroy.push(()=>C());let{clock:y}=e,{tick:I}=e,{game:m}=e;const d=p=>i(p),b=(p,H,B,P)=>{if(H||B)return!1;switch(p){case"`":return y.toggle(),!0;case"1":return I(),!0;case"2":return I(),I(),!0;case"0":return vn(m.storageKey),!0;case"3":{for(let Z=0;Z<10;Z++)I();return!0}case"g":case"r":return c(),!0;case"ArrowUp":case"w":case"k":case"W":case"K":return _==="win"||_==="fail"||_==="ready"&&!u()||(P?(l("up"),I()):i("up")),!0;case"ArrowDown":case"s":case"j":case"S":case"J":return _==="win"||_==="fail"||_==="ready"&&!u()||(P?(l("down"),I()):i("down")),!0;case"ArrowLeft":case"a":case"h":case"A":case"H":return _==="win"||_==="fail"||_==="ready"&&!u()||(P?(l("left"),I()):i("left")),!0;case"ArrowRight":case"d":case"l":case"D":case"L":return _==="win"||_==="fail"||_==="ready"&&!u()||(P?(l("right"),I()):i("right")),!0}return!1};return n.$$set=p=>{"clock"in p&&t(0,y=p.clock),"tick"in p&&t(1,I=p.tick),"game"in p&&t(2,m=p.game)},n.$$.update=()=>{n.$$.dirty&4&&k(t(10,{movementCommandQueue:s,enqueueMovementCommand:i,MOVEMENT_COMMAND_QUEUE_SIZE:o,status:r,setMovementCommand:l,start:u,reset:c}=m,s,(t(9,i),t(2,m)),(t(8,o),t(2,m)),S(t(7,r)),(t(6,l),t(2,m)),(t(5,u),t(2,m)),(t(4,c),t(2,m)))),n.$$.dirty&4096&&t(3,a=f==null?void 0:f[0])},[y,I,m,a,c,u,l,r,o,i,s,_,f,d,b]}class Bi extends F{constructor(e){super(),j(this,e,Js,xs,Q,{clock:0,tick:1,game:2})}}function Zs(n){let e,t,s,i="r",o,r="-25px",l,u,c;const a=n[2].default,f=Xe(a,n,n[1],null);return{c(){e=D("div"),t=he("presss "),s=D("button"),s.textContent=i,o=he(" to go again "),f&&f.c(),this.h()},l(h){e=E(h,"DIV",{});var k=R(e);t=de(k,"presss "),s=E(k,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(s)!=="svelte-1vafq3m"&&(s.textContent=i),o=de(k," to go again "),f&&f.l(k),k.forEach(w),this.h()},h(){g(s,"class","inline icon-button"),A(e,"position","relative"),A(e,"left",r)},m(h,k){U(h,e,k),v(e,t),v(e,s),v(e,o),f&&f.m(e,null),l=!0,u||(c=X(s,"click",n[3]),u=!0)},p(h,[k]){f&&f.p&&(!l||k&2)&&qe(f,a,h,h[1],l?Ve(a,h[1],k,null):Le(h[1]),null)},i(h){l||(q(f,h),l=!0)},o(h){Y(f,h),l=!1},d(h){h&&w(e),f&&f.d(h),u=!1,c()}}}function $s(n,e,t){let{$$slots:s={},$$scope:i}=e,{restart:o}=e;const r=()=>o();return n.$$set=l=>{"restart"in l&&t(0,o=l.restart),"$$scope"in l&&t(1,i=l.$$scope)},[o,i,s,r]}class Xi extends F{constructor(e){super(),j(this,e,$s,Zs,Q,{restart:0})}}function ei(n){let e,t,s,i=`scale3d(${n[5]}, ${n[5]}, 1)`,o;const r=n[9].default,l=Xe(r,n,n[8],null);return{c(){e=D("div"),t=D("div"),s=D("div"),l&&l.c(),this.h()},l(u){e=E(u,"DIV",{class:!0});var c=R(e);t=E(c,"DIV",{});var a=R(t);s=E(a,"DIV",{class:!0});var f=R(s);l&&l.l(f),f.forEach(w),a.forEach(w),c.forEach(w),this.h()},h(){g(s,"class","world svelte-196hf72"),A(s,"--world_width",n[2]),A(s,"--world_height",n[3]),A(t,"transform",i),g(e,"class","scaled-world svelte-196hf72"),A(e,"--screen_width",n[0]),A(e,"--screen_height",n[1]),A(e,"--renderer_scale",n[4])},m(u,c){U(u,e,c),v(e,t),v(t,s),l&&l.m(s,null),o=!0},p(u,[c]){l&&l.p&&(!o||c&256)&&qe(l,r,u,u[8],o?Ve(r,u[8],c,null):Le(u[8]),null),c&4&&A(s,"--world_width",u[2]),c&8&&A(s,"--world_height",u[3]),c&32&&i!==(i=`scale3d(${u[5]}, ${u[5]}, 1)`)&&A(t,"transform",i),c&1&&A(e,"--screen_width",u[0]),c&2&&A(e,"--screen_height",u[1]),c&16&&A(e,"--renderer_scale",u[4])},i(u){o||(q(l,u),o=!0)},o(u){Y(l,u),o=!1},d(u){u&&w(e),l&&l.d(u)}}}const ti=512;function ni(n,e,t){let s,i,o,r,{$$slots:l={},$$scope:u}=e,{screenWidth:c}=e,{screenHeight:a}=e,{worldWidth:f}=e,{worldHeight:h}=e;return n.$$set=k=>{"screenWidth"in k&&t(0,c=k.screenWidth),"screenHeight"in k&&t(1,a=k.screenHeight),"worldWidth"in k&&t(2,f=k.worldWidth),"worldHeight"in k&&t(3,h=k.worldHeight),"$$scope"in k&&t(8,u=k.$$scope)},n.$$.update=()=>{n.$$.dirty&5&&t(7,s=Math.min(1,c/f)),n.$$.dirty&10&&t(6,i=Math.min(1,a/h)),n.$$.dirty&192&&t(5,o=Math.min(s,i)),n.$$.dirty&12&&t(4,r=Math.min(f,h)/ti)},[c,a,f,h,r,o,i,s,u,l]}class si extends F{constructor(e){super(),j(this,e,ni,ei,Q,{screenWidth:0,screenHeight:1,worldWidth:2,worldHeight:3})}}const ii=n=>({worldWidth:n&64,worldHeight:n&128}),on=n=>({worldWidth:n[6],worldHeight:n[7]});function ri(n){let e;const t=n[19].default,s=Xe(t,n,n[20],on);return{c(){s&&s.c()},l(i){s&&s.l(i)},m(i,o){s&&s.m(i,o),e=!0},p(i,o){s&&s.p&&(!e||o&1048768)&&qe(s,t,i,i[20],e?Ve(t,i[20],o,ii):Le(i[20]),on)},i(i){e||(q(s,i),e=!0)},o(i){Y(s,i),e=!1},d(i){s&&s.d(i)}}}function oi(n){let e,t;return e=new si({props:{screenWidth:n[8],screenHeight:n[5],worldWidth:n[6],worldHeight:n[7],$$slots:{default:[ri]},$$scope:{ctx:n}}}),{c(){ye(e.$$.fragment)},l(s){we(e.$$.fragment,s)},m(s,i){De(e,s,i),t=!0},p(s,[i]){const o={};i&256&&(o.screenWidth=s[8]),i&32&&(o.screenHeight=s[5]),i&64&&(o.worldWidth=s[6]),i&128&&(o.worldHeight=s[7]),i&1048768&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(q(e.$$.fragment,s),t=!0)},o(s){Y(e.$$.fragment,s),t=!1},d(s){Ee(e,s)}}}function li(n,e,t){let s,i,o,r,l,u=M,c=()=>(u(),u=K(G,N=>t(21,l=N)),G),a,f=M,h=()=>(f(),f=K(ce,N=>t(22,a=N)),ce),k,_=M,C=()=>(_(),_=K(re,N=>t(16,k=N)),re),S,y=M,I=()=>(y(),y=K(x,N=>t(17,S=N)),x),m,d=M,b=()=>(d(),d=K(B,N=>t(18,m=N)),B);n.$$.on_destroy.push(()=>u()),n.$$.on_destroy.push(()=>f()),n.$$.on_destroy.push(()=>_()),n.$$.on_destroy.push(()=>y()),n.$$.on_destroy.push(()=>d());let{$$slots:p={},$$scope:H}=e,{dimensions:B}=e;b();let{marginX:P=32}=e,{marginTop:Z=320}=e,{marginBottom:se=83}=e;const ce=ke(0);h();const G=ke(0);c();const x=ke(!1);I();const re=ke(1);C();const ne=(N,ee,le)=>{const ie=N/ee;return ie>le?{width:N*(le/ie),height:ee}:ie<le?{width:N,height:ee*(ie/le)}:{width:N,height:ee}};let $,oe,ve,J;return n.$$set=N=>{"dimensions"in N&&b(t(0,B=N.dimensions)),"marginX"in N&&t(9,P=N.marginX),"marginTop"in N&&t(10,Z=N.marginTop),"marginBottom"in N&&t(11,se=N.marginBottom),"$$scope"in N&&t(20,H=N.$$scope)},n.$$.update=()=>{if(n.$$.dirty&262656&&t(15,s=Math.max(0,m.width-P)),n.$$.dirty&265216&&t(14,i=Math.max(0,m.height-Z-se)),n.$$.dirty&196608&&t(13,o=S?null:k),n.$$.dirty&57344)if(o===null)t(8,$=s),t(5,oe=i),t(6,ve=s),t(7,J=i);else{const N=ne(s,i,o);t(8,$=N.width),t(5,oe=N.height);const ee=ne(s,i,o);t(6,ve=ee.width),t(7,J=ee.height)}n.$$.dirty&192&&(te(ce,a=ve,a),te(G,l=J,l)),n.$$.dirty&1056&&t(12,r=Z+oe/2),n.$$.dirty&4096&&document.body.style.setProperty("--bg_y",r+"px")},[B,ce,G,x,re,oe,ve,J,$,P,Z,se,r,o,i,s,k,S,m,p,H]}class qi extends F{constructor(e){super(),j(this,e,li,oi,Q,{dimensions:0,marginX:9,marginTop:10,marginBottom:11,rendererWidth:1,rendererHeight:2,autoAspectRatio:3,aspectRatio:4})}get rendererWidth(){return this.$$.ctx[1]}get rendererHeight(){return this.$$.ctx[2]}get autoAspectRatio(){return this.$$.ctx[3]}get aspectRatio(){return this.$$.ctx[4]}}function ui(n){let e,t='<h2>controls</h2> <div class="group svelte-y57lwn"><div><strong class="svelte-y57lwn">queue a move</strong>: <code>tap</code> or <code>click</code> the environment</div> <div>or press\n			<code>arrow keys</code>, <code>wasd</code>, <code>hjkl</code></div></div> <div><strong class="svelte-y57lwn">move and end turn</strong>: hold <code>shift</code> and move</div> <div><strong class="svelte-y57lwn">toggle clock</strong>: <code>Backtick `</code></div> <div><strong class="svelte-y57lwn">take one turn</strong>: <code>1</code></div> <div><strong class="svelte-y57lwn">delete all saved data</strong>: <code>0</code></div> <div><strong class="svelte-y57lwn">toggle song</strong>: <code>=</code></div> <div><strong class="svelte-y57lwn">restart</strong>: <code>r</code> or <code>g</code></div>';return{c(){e=D("div"),e.innerHTML=t,this.h()},l(s){e=E(s,"DIV",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-11xcndb"&&(e.innerHTML=t),this.h()},h(){g(e,"class","prose svelte-y57lwn")},m(s,i){U(s,e,i)},p:M,i:M,o:M,d(s){s&&w(e)}}}class Li extends F{constructor(e){super(),j(this,e,null,ui,Q,{})}}function ci(n){let e,t,s,i,o;return i=new kn({props:{onKeydown:n[7]}}),{c(){e=D("audio"),s=L(),ye(i.$$.fragment),this.h()},l(r){e=E(r,"AUDIO",{src:!0}),R(e).forEach(w),s=V(r),we(i.$$.fragment,r),this.h()},h(){bt(e.src,t=n[1])||g(e,"src",t),e.controls=!0},m(r,l){U(r,e,l),n[6](e),U(r,s,l),De(i,r,l),o=!0},p(r,[l]){(!o||l&2&&!bt(e.src,t=r[1]))&&g(e,"src",t)},i(r){o||(q(i.$$.fragment,r),o=!0)},o(r){Y(i.$$.fragment,r),o=!1},d(r){r&&(w(e),w(s)),n[6](null),Ee(i,r)}}}function ai(n,e,t){let{song:s}=e,{el:i=void 0}=e,{playing:o=!1}=e;const r=()=>{o||(t(3,o=!0),i==null||i.play())},l=()=>{o&&(i==null||i.pause(),t(3,o=!1))},u=()=>o?l():r();function c(f){Fe[f?"unshift":"push"](()=>{i=f,t(0,i)})}const a=(f,h,k)=>{if(h||k)return!1;switch(f){case"=":return u(),!0}return!1};return n.$$set=f=>{"song"in f&&t(1,s=f.song),"el"in f&&t(0,i=f.el),"playing"in f&&t(3,o=f.playing)},[i,s,u,o,r,l,c,a]}class Vi extends F{constructor(e){super(),j(this,e,ai,ci,Q,{song:1,el:0,playing:3,play:4,pause:5,toggle:2})}get play(){return this.$$.ctx[4]}get pause(){return this.$$.ctx[5]}get toggle(){return this.$$.ctx[2]}}function fi(n){let e,t;return{c(){e=D("div"),this.h()},l(s){e=E(s,"DIV",{class:!0}),R(e).forEach(w),this.h()},h(){g(e,"class","svelte-26zrl3"),vt(()=>n[3].call(e))},m(s,i){U(s,e,i),t=In(e,n[3].bind(e))},p:M,i:M,o:M,d(s){s&&w(e),t()}}}function hi(n,e,t){let s,i=M,o=()=>(i(),i=K(r,a=>t(4,s=a)),r);n.$$.on_destroy.push(()=>i());let{dimensions:r}=e;o();let l=0,u=0;function c(){l=this.clientWidth,u=this.clientHeight,t(1,l),t(2,u)}return n.$$set=a=>{"dimensions"in a&&o(t(0,r=a.dimensions))},n.$$.update=()=>{n.$$.dirty&6&&l&&u&&te(r,s={width:l,height:u},s)},[r,l,u,c]}class Ki extends F{constructor(e){super(),j(this,e,hi,fi,Q,{dimensions:0})}}function di(n){let e,t,s="🐍",i,o,r,l=[{alt:n[0]},{src:r=n[1]},n[2]],u={};for(let c=0;c<l.length;c+=1)u=pt(u,l[c]);return{c(){e=D("div"),t=D("a"),t.textContent=s,i=L(),o=D("img"),this.h()},l(c){e=E(c,"DIV",{class:!0});var a=R(e);t=E(a,"A",{href:!0,class:!0,"data-svelte-h":!0}),ue(t)!=="svelte-1nnt4qw"&&(t.textContent=s),i=V(a),o=E(a,"IMG",{alt:!0,src:!0}),a.forEach(w),this.h()},h(){g(t,"href",Tn+"/"),g(t,"class","svelte-10sutq2"),Ct(o,u),fe(o,"svelte-10sutq2",!0),g(e,"class","title_image svelte-10sutq2")},m(c,a){U(c,e,a),v(e,t),v(e,i),v(e,o)},p(c,[a]){Ct(o,u=Mn(l,[a&1&&{alt:c[0]},a&2&&!bt(o.src,r=c[1])&&{src:r},a&4&&c[2]])),fe(o,"svelte-10sutq2",!0)},i:M,o:M,d(c){c&&w(e)}}}function mi(n,e,t){const s=["alt","src"];let i=Dt(e,s),{alt:o}=e,{src:r}=e;return n.$$set=l=>{e=pt(pt({},e),Dn(l)),t(2,i=Dt(e,s)),"alt"in l&&t(0,o=l.alt),"src"in l&&t(1,r=l.src)},[o,r,i]}class Yi extends F{constructor(e){super(),j(this,e,mi,di,Q,{alt:0,src:1})}}export{Li as C,Ki as D,Ne as E,Ii as G,Xi as R,Oi as S,Wi as T,Ei as a,Ti as b,es as c,Ri as d,Bi as e,Vi as f,Si as g,Ui as h,Hi as i,Ai as j,yi as k,wi as l,qi as m,Pi as n,Mi as o,Ms as p,Yi as q,Fn as r,Ci as s,kt as t,ki as u,Di as v,Ni as w};
