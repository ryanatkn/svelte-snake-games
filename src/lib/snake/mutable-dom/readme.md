TODO should we move most of of the stuff in $lib to here?
